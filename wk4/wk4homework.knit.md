
<!-- rnb-text-begin -->

---
title: Week 4 Homework
author: "Author: Laura Wooten"
date: "Last update: 29 April, 2025" 
output: 
  html_notebook:
    code_folding: 
    number_sections: true
---
> For this question, you will need to download a data set from the UCI machine learning repository. Separate the data set you downloaded into two groups by the outcome variable that is being studied. In the UCR machine learning repository, most of the time, this will be categorical variable in the “last column” in the data set. If more than one outcome was studied, use the one with the greatest number of records. Then, take a random sample of N=30 measurement from a selected column from each of the subsetted data sets that were partitioned by feature. Then compute the difference in their means and construct a 95% confidence interval for the difference using t.test(). Do this 1,000 times and keep track of all the confidence intervals. One way to answer this question is to use the replicate() function in R, which will return a 2 x 1000 matrix of the lower and upper bound for each of the 1000 replications.

Dont forget to cite data.  
Steps:  
1. read in data
2. adknowledge ? in bare-nuc  
3. Separate data by outcome  
4. Select column of interest  
5. For each df: random sample n=30  
6. difference in sample means -compare against outcomes, 95% CI t-test.  
7. rpt 1000 times


<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVaR0YwWVM1MFltd2dQQzBnY21WaFpDNTBZV0pzWlNoY0ltSnlaV0Z6ZEMxallXNWpaWEl0ZDJselkyOXVjMmx1TG1SaGRHRmNJaXdnYUdWaFpHVnlJRDBnUmtGTVUwVXNJSE5sY0NBOVhDSXNYQ0lzSUdOdmJDNXVZVzFsY3lBOUlHTW9YQ0pwWkZ3aUxDQmNJbU5zZFcxd1gzUm9hV05yYm1WemMxd2lMQ0JjSW5WdWFXWmZjMmw2WlZ3aUxDQmNJblZ1YVdaZmMyaGhjR1ZjSWl3Z1hDSmhaR2hsYzJsdmJsd2lMQ0JjSW5OcGJtZHNaVjlsY0dsZmMybDZaVndpTENCY0ltSmhjbVZmYm5WamJHVnBYQ0lzSUZ3aVlteGhibVJmWTJoeWIyMWhkR2x1WENJc0lGd2libTl5YldGc1gyNTFZMnhsYjJ4cFhDSXNJRndpYldsMGIzTmxjMXdpTENCY0luTjBZWFIxYzF3aUtTbGNibHh1STNCeVpYWnBaWGRjYm1SaGRHRXVkR0pzV3pFNk5TeGRYRzVnWUdBaWZRPT0gLS0+XG5cbmBgYHJcbmRhdGEudGJsIDwtIHJlYWQudGFibGUoXCJicmVhc3QtY2FuY2VyLXdpc2NvbnNpbi5kYXRhXCIsIGhlYWRlciA9IEZBTFNFLCBzZXAgPVwiLFwiLCBjb2wubmFtZXMgPSBjKFwiaWRcIiwgXCJjbHVtcF90aGlja25lc3NcIiwgXCJ1bmlmX3NpemVcIiwgXCJ1bmlmX3NoYXBlXCIsIFwiYWRoZXNpb25cIiwgXCJzaW5nbGVfZXBpX3NpemVcIiwgXCJiYXJlX251Y2xlaVwiLCBcImJsYW5kX2Nocm9tYXRpblwiLCBcIm5vcm1hbF9udWNsZW9saVwiLCBcIm1pdG9zZXNcIiwgXCJzdGF0dXNcIikpXG5cbiNwcmV2aWV3XG5kYXRhLnRibFsxOjUsXVxuYGBgXG5cbjwhLS0gcm5iLXNvdXJjZS1lbmQgLS0+XG4ifQ== -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZGF0YS50YmwgPC0gcmVhZC50YWJsZShcImJyZWFzdC1jYW5jZXItd2lzY29uc2luLmRhdGFcIiwgaGVhZGVyID0gRkFMU0UsIHNlcCA9XCIsXCIsIGNvbC5uYW1lcyA9IGMoXCJpZFwiLCBcImNsdW1wX3RoaWNrbmVzc1wiLCBcInVuaWZfc2l6ZVwiLCBcInVuaWZfc2hhcGVcIiwgXCJhZGhlc2lvblwiLCBcInNpbmdsZV9lcGlfc2l6ZVwiLCBcImJhcmVfbnVjbGVpXCIsIFwiYmxhbmRfY2hyb21hdGluXCIsIFwibm9ybWFsX251Y2xlb2xpXCIsIFwibWl0b3Nlc1wiLCBcInN0YXR1c1wiKSlcblxuI3ByZXZpZXdcbmRhdGEudGJsWzE6NSxdXG5gYGAifQ== -->

```r
data.tbl <- read.table("breast-cancer-wisconsin.data", header = FALSE, sep =",", col.names = c("id", "clump_thickness", "unif_size", "unif_shape", "adhesion", "single_epi_size", "bare_nuclei", "bland_chromatin", "normal_nucleoli", "mitoses", "status"))

#preview
data.tbl[1:5,]
```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVkVzVzYVhOMEtHeGhjSEJzZVNoa1lYUmhMblJpYkZzc01Ub3hNVjBzWTJ4aGMzTXBLVnh1STJKaGNtVmZiblZqYkdWcElHbHpJR05vWVhKaFkzUmxjajljYm5WdWFYRjFaU2hrWVhSaExuUmliRnNzTjEwcFhHNWNiaU55WlhCc1lXTmxJRDhnZDJsMGFDQk9RU0JoYm1RZ1kyOXVkbVZ5ZENCMGJ5QnVkVzFsY21salhHNWtZWFJoTG5SaWJGc3NOMTBnUEMwZ1lYTXViblZ0WlhKcFl5aHlaWEJzWVdObEtHUmhkR0V1ZEdKc1d5dzNYU3dnWkdGMFlTNTBZbXhiTERkZFBUMWNJajljSWl3Z1RrRXBLVnh1WEc0alkyaGhibWRsSUhOMFlYUjFjeUJqYjJ4MWJXNGdkRzhnT2lBeVBVSmxibWxuYml3Z05EMU5ZV3hwWjI1aGJuUmNibVJoZEdFdWRHSnNXeXd4TVYwZ1BDMGdjbVZ3YkdGalpTaGtZWFJoTG5SaWJGc3NNVEZkTENCa1lYUmhMblJpYkZzc01URmRQVDB5TENCY0lrSmxibWxuYmx3aUtWeHVaR0YwWVM1MFlteGJMREV4WFNBOExTQnlaWEJzWVdObEtHUmhkR0V1ZEdKc1d5d3hNVjBzSUdSaGRHRXVkR0pzV3l3eE1WMDlQVFFzSUZ3aVRXRnNhV2R1WVc1MFhDSXBYRzVjYmlOamFHRnVaMlVnYldGc2FXZHVZVzUwSUdOdmJIVnRiaUIwYnlCbVlXTjBiM0pjYm1SaGRHRXVkR0pzSkhOMFlYUjFjeUE4TFNCaGN5NW1ZV04wYjNJb1pHRjBZUzUwWW13a2MzUmhkSFZ6S1Z4dVhHNGpjMlZ3WVhKaGRHVWdaR0YwWVNCcGJuUnZJRElnWkdaeklHSjVJRzkxZEdOdmJXVmNibUpsYmk1a1lYUmhJRHd0SUdSaGRHRXVkR0pzVzJSaGRHRXVkR0pzSkhOMFlYUjFjejA5SUZ3aVFtVnVhV2R1WENJc1hWeHViV0ZzTG1SaGRHRWdQQzBnSUdSaGRHRXVkR0pzVzJSaGRHRXVkR0pzSkhOMFlYUjFjejA5WENKTllXeHBaMjVoYm5SY0lpeGRYRzVnWUdBaWZRPT0gLS0+XG5cbmBgYHJcbnVubGlzdChsYXBwbHkoZGF0YS50YmxbLDE6MTFdLGNsYXNzKSlcbiNiYXJlX251Y2xlaSBpcyBjaGFyYWN0ZXI/XG51bmlxdWUoZGF0YS50YmxbLDddKVxuXG4jcmVwbGFjZSA/IHdpdGggTkEgYW5kIGNvbnZlcnQgdG8gbnVtZXJpY1xuZGF0YS50YmxbLDddIDwtIGFzLm51bWVyaWMocmVwbGFjZShkYXRhLnRibFssN10sIGRhdGEudGJsWyw3XT09XCI/XCIsIE5BKSlcblxuI2NoYW5nZSBzdGF0dXMgY29sdW1uIHRvIDogMj1CZW5pZ24sIDQ9TWFsaWduYW50XG5kYXRhLnRibFssMTFdIDwtIHJlcGxhY2UoZGF0YS50YmxbLDExXSwgZGF0YS50YmxbLDExXT09MiwgXCJCZW5pZ25cIilcbmRhdGEudGJsWywxMV0gPC0gcmVwbGFjZShkYXRhLnRibFssMTFdLCBkYXRhLnRibFssMTFdPT00LCBcIk1hbGlnbmFudFwiKVxuXG4jY2hhbmdlIG1hbGlnbmFudCBjb2x1bW4gdG8gZmFjdG9yXG5kYXRhLnRibCRzdGF0dXMgPC0gYXMuZmFjdG9yKGRhdGEudGJsJHN0YXR1cylcblxuI3NlcGFyYXRlIGRhdGEgaW50byAyIGRmcyBieSBvdXRjb21lXG5iZW4uZGF0YSA8LSBkYXRhLnRibFtkYXRhLnRibCRzdGF0dXM9PSBcIkJlbmlnblwiLF1cbm1hbC5kYXRhIDwtICBkYXRhLnRibFtkYXRhLnRibCRzdGF0dXM9PVwiTWFsaWduYW50XCIsXVxuYGBgXG5cbjwhLS0gcm5iLXNvdXJjZS1lbmQgLS0+XG4ifQ== -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxudW5saXN0KGxhcHBseShkYXRhLnRibFssMToxMV0sY2xhc3MpKVxuI2JhcmVfbnVjbGVpIGlzIGNoYXJhY3Rlcj9cbnVuaXF1ZShkYXRhLnRibFssN10pXG5cbiNyZXBsYWNlID8gd2l0aCBOQSBhbmQgY29udmVydCB0byBudW1lcmljXG5kYXRhLnRibFssN10gPC0gYXMubnVtZXJpYyhyZXBsYWNlKGRhdGEudGJsWyw3XSwgZGF0YS50YmxbLDddPT1cIj9cIiwgTkEpKVxuXG4jY2hhbmdlIHN0YXR1cyBjb2x1bW4gdG8gOiAyPUJlbmlnbiwgND1NYWxpZ25hbnRcbmRhdGEudGJsWywxMV0gPC0gcmVwbGFjZShkYXRhLnRibFssMTFdLCBkYXRhLnRibFssMTFdPT0yLCBcIkJlbmlnblwiKVxuZGF0YS50YmxbLDExXSA8LSByZXBsYWNlKGRhdGEudGJsWywxMV0sIGRhdGEudGJsWywxMV09PTQsIFwiTWFsaWduYW50XCIpXG5cbiNjaGFuZ2UgbWFsaWduYW50IGNvbHVtbiB0byBmYWN0b3JcbmRhdGEudGJsJHN0YXR1cyA8LSBhcy5mYWN0b3IoZGF0YS50Ymwkc3RhdHVzKVxuXG4jc2VwYXJhdGUgZGF0YSBpbnRvIDIgZGZzIGJ5IG91dGNvbWVcbmJlbi5kYXRhIDwtIGRhdGEudGJsW2RhdGEudGJsJHN0YXR1cz09IFwiQmVuaWduXCIsXVxubWFsLmRhdGEgPC0gIGRhdGEudGJsW2RhdGEudGJsJHN0YXR1cz09XCJNYWxpZ25hbnRcIixdXG5gYGAifQ== -->

```r
unlist(lapply(data.tbl[,1:11],class))
#bare_nuclei is character?
unique(data.tbl[,7])

#replace ? with NA and convert to numeric
data.tbl[,7] <- as.numeric(replace(data.tbl[,7], data.tbl[,7]=="?", NA))

#change status column to : 2=Benign, 4=Malignant
data.tbl[,11] <- replace(data.tbl[,11], data.tbl[,11]==2, "Benign")
data.tbl[,11] <- replace(data.tbl[,11], data.tbl[,11]==4, "Malignant")

#change malignant column to factor
data.tbl$status <- as.factor(data.tbl$status)

#separate data into 2 dfs by outcome
ben.data <- data.tbl[data.tbl$status== "Benign",]
mal.data <-  data.tbl[data.tbl$status=="Malignant",]
```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVJMk5vYjI5elpTQmhJR052YkhWdGJpQW9hVzVrWlhCbGJtUmxiblFnZG1GeWFXRmliR1VwSUMwZ1kyeDFiWEFnZEdocFkydHVaWE56SUZzc01WMWNiaU5HYjNJZ1pXRmphQ0JrWmpvZ2NtRnVaRzl0SUhOaGJYQnNaU0J1UFRNd0lDQmNiaU5rYVdabVpYSmxibU5sSUdsdUlITmhiWEJzWlNCdFpXRnVjeUF0WTI5dGNHRnlaU0JoWjJGcGJuTjBJRzkxZEdOdmJXVnpMQ0E1TlNVZ1Ewa2dkQzEwWlhOMExseHVablZ1TVNBOExTQm1kVzVqZEdsdmJpaGlaVzR1WkdGMFlTd2diV0ZzTG1SaGRHRXNJR052YkhWdGJpd2djMjF3YkM1emFYcGxQVE13S1h0Y2JpQWdJM0IxYkd3Z2NtRnVaRzl0SUhOaGJYQnNaU0JtY205dElHVmhZMmdnYjNWMFkyOXRaVnh1SUNCaVpXNHVjMjF3YkNBOExTQnpZVzF3YkdVb2JtRXViMjFwZENoaVpXNHVaR0YwWVZ0YlkyOXNkVzF1WFYwcExDQnpiWEJzTG5OcGVtVXNJSEpsY0d4aFkyVWdQU0JVS1NBamMyVjBJSFJ2SUhKbGNHeGhZMlVnYzI4Z2RHaGhkQ0JsWVdOb0lITmhiWEJzWlNCcGN5QnBibVJsY0dWdVpHVnVkRnh1SUNCdFlXd3VjMjF3YkNBOExTQnpZVzF3YkdVb2JtRXViMjFwZENodFlXd3VaR0YwWVZ0YlkyOXNkVzF1WFYwcExDQnpiWEJzTG5OcGVtVXNJSEpsY0d4aFkyVWdQVlFwWEc0Z0lGeHVJQ0FqWTJGc1l5QnRaV0Z1YzF4dUlDQmlaVzR1YlhVZ1BDMGdiV1ZoYmloaVpXNHVjMjF3YkNsY2JpQWdiV0ZzTG0xMUlEd3RJRzFsWVc0b2JXRnNMbk50Y0d3cFhHNGdJRnh1SUNBalkyRnNZeUJrYVdabVpYSmxibU5sSUdsdUlHMWxZVzV6WEc0Z0lHUnBabVl1YlhVZ1BDMGdiV0ZzTG0xMUlDMGdZbVZ1TG0xMUlDTmlZWE5sWkNCdmJpQnhkV2xqYXlCMmFXVjNJRzltSUcxbFlXNXpMQ0J0WVd4cFoyNWhiblFnYjNWMFkyOXRaU0JwY3lCb2FXZG9aWEpjYmlBZ1hHNGdJQ053WlhKbWIzSnRJSFF0ZEdWemRDQnZiaUJrYVdabVpYSmxibU5sSUdsdUlHMWxZVzV6WEc0Z0lHTnBMamsxSUR3dElIUXVkR1Z6ZENodFlXd3VjMjF3YkN3Z1ltVnVMbk50Y0d3c0lHTnZibVl1YkdWMlpXdzlJREF1T1RVcFhHNGdYRzRnSUNOeVpYUjFjbTRvYkdsemRDaGthV1ptTG0xMUxDQmphUzQ1TlNrcElDTnlaWFIxY201eklHWjFiR3dnZEMxMFpYTjBJRDRnZEhKNUlDUmpiMjVtTG1sdWRGeHVJQ0FqY21WMGRYSnVLR3hwYzNRb1pHbG1aaTV0ZFN3Z1kya3VPVFVrWTI5dVppNXBiblFwS1NBalkyOXVaaTVwYm5RZ2NtVjBkWEp1Y3lBeklHbDBaVzF6TENCMGNua2dhWE52YkdGMFpTQnNiM2RsY2lCaGJtUWdkWEJ3WlhJZ1ltOTFibVJ6SUc5dWJIbGNiaUFnY21WMGRYSnVLR01vWkdsbVppNXRkU3dnWTJrdU9UVWtZMjl1Wmk1cGJuUmJNVjBzSUdOcExqazFKR052Ym1ZdWFXNTBXekpkS1NsY2JuMWNibHh1WEc1Z1lHQWlmUT09IC0tPlxuXG5gYGByXG4jY2hvb3NlIGEgY29sdW1uIChpbmRlcGVuZGVudCB2YXJpYWJsZSkgLSBjbHVtcCB0aGlja25lc3MgWywxXVxuI0ZvciBlYWNoIGRmOiByYW5kb20gc2FtcGxlIG49MzAgIFxuI2RpZmZlcmVuY2UgaW4gc2FtcGxlIG1lYW5zIC1jb21wYXJlIGFnYWluc3Qgb3V0Y29tZXMsIDk1JSBDSSB0LXRlc3QuXG5mdW4xIDwtIGZ1bmN0aW9uKGJlbi5kYXRhLCBtYWwuZGF0YSwgY29sdW1uLCBzbXBsLnNpemU9MzApe1xuICAjcHVsbCByYW5kb20gc2FtcGxlIGZyb20gZWFjaCBvdXRjb21lXG4gIGJlbi5zbXBsIDwtIHNhbXBsZShuYS5vbWl0KGJlbi5kYXRhW1tjb2x1bW5dXSksIHNtcGwuc2l6ZSwgcmVwbGFjZSA9IFQpICNzZXQgdG8gcmVwbGFjZSBzbyB0aGF0IGVhY2ggc2FtcGxlIGlzIGluZGVwZW5kZW50XG4gIG1hbC5zbXBsIDwtIHNhbXBsZShuYS5vbWl0KG1hbC5kYXRhW1tjb2x1bW5dXSksIHNtcGwuc2l6ZSwgcmVwbGFjZSA9VClcbiAgXG4gICNjYWxjIG1lYW5zXG4gIGJlbi5tdSA8LSBtZWFuKGJlbi5zbXBsKVxuICBtYWwubXUgPC0gbWVhbihtYWwuc21wbClcbiAgXG4gICNjYWxjIGRpZmZlcmVuY2UgaW4gbWVhbnNcbiAgZGlmZi5tdSA8LSBtYWwubXUgLSBiZW4ubXUgI2Jhc2VkIG9uIHF1aWNrIHZpZXcgb2YgbWVhbnMsIG1hbGlnbmFudCBvdXRjb21lIGlzIGhpZ2hlclxuICBcbiAgI3BlcmZvcm0gdC10ZXN0IG9uIGRpZmZlcmVuY2UgaW4gbWVhbnNcbiAgY2kuOTUgPC0gdC50ZXN0KG1hbC5zbXBsLCBiZW4uc21wbCwgY29uZi5sZXZlbD0gMC45NSlcbiBcbiAgI3JldHVybihsaXN0KGRpZmYubXUsIGNpLjk1KSkgI3JldHVybnMgZnVsbCB0LXRlc3QgPiB0cnkgJGNvbmYuaW50XG4gICNyZXR1cm4obGlzdChkaWZmLm11LCBjaS45NSRjb25mLmludCkpICNjb25mLmludCByZXR1cm5zIDMgaXRlbXMsIHRyeSBpc29sYXRlIGxvd2VyIGFuZCB1cHBlciBib3VuZHMgb25seVxuICByZXR1cm4oYyhkaWZmLm11LCBjaS45NSRjb25mLmludFsxXSwgY2kuOTUkY29uZi5pbnRbMl0pKVxufVxuXG5cbmBgYFxuXG48IS0tIHJuYi1zb3VyY2UtZW5kIC0tPlxuIn0= -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuI2Nob29zZSBhIGNvbHVtbiAoaW5kZXBlbmRlbnQgdmFyaWFibGUpIC0gY2x1bXAgdGhpY2tuZXNzIFssMV1cbiNGb3IgZWFjaCBkZjogcmFuZG9tIHNhbXBsZSBuPTMwICBcbiNkaWZmZXJlbmNlIGluIHNhbXBsZSBtZWFucyAtY29tcGFyZSBhZ2FpbnN0IG91dGNvbWVzLCA5NSUgQ0kgdC10ZXN0LlxuZnVuMSA8LSBmdW5jdGlvbihiZW4uZGF0YSwgbWFsLmRhdGEsIGNvbHVtbiwgc21wbC5zaXplPTMwKXtcbiAgI3B1bGwgcmFuZG9tIHNhbXBsZSBmcm9tIGVhY2ggb3V0Y29tZVxuICBiZW4uc21wbCA8LSBzYW1wbGUobmEub21pdChiZW4uZGF0YVtbY29sdW1uXV0pLCBzbXBsLnNpemUsIHJlcGxhY2UgPSBUKSAjc2V0IHRvIHJlcGxhY2Ugc28gdGhhdCBlYWNoIHNhbXBsZSBpcyBpbmRlcGVuZGVudFxuICBtYWwuc21wbCA8LSBzYW1wbGUobmEub21pdChtYWwuZGF0YVtbY29sdW1uXV0pLCBzbXBsLnNpemUsIHJlcGxhY2UgPVQpXG4gIFxuICAjY2FsYyBtZWFuc1xuICBiZW4ubXUgPC0gbWVhbihiZW4uc21wbClcbiAgbWFsLm11IDwtIG1lYW4obWFsLnNtcGwpXG4gIFxuICAjY2FsYyBkaWZmZXJlbmNlIGluIG1lYW5zXG4gIGRpZmYubXUgPC0gbWFsLm11IC0gYmVuLm11ICNiYXNlZCBvbiBxdWljayB2aWV3IG9mIG1lYW5zLCBtYWxpZ25hbnQgb3V0Y29tZSBpcyBoaWdoZXJcbiAgXG4gICNwZXJmb3JtIHQtdGVzdCBvbiBkaWZmZXJlbmNlIGluIG1lYW5zXG4gIGNpLjk1IDwtIHQudGVzdChtYWwuc21wbCwgYmVuLnNtcGwsIGNvbmYubGV2ZWw9IDAuOTUpXG4gXG4gICNyZXR1cm4obGlzdChkaWZmLm11LCBjaS45NSkpICNyZXR1cm5zIGZ1bGwgdC10ZXN0ID4gdHJ5ICRjb25mLmludFxuICAjcmV0dXJuKGxpc3QoZGlmZi5tdSwgY2kuOTUkY29uZi5pbnQpKSAjY29uZi5pbnQgcmV0dXJucyAzIGl0ZW1zLCB0cnkgaXNvbGF0ZSBsb3dlciBhbmQgdXBwZXIgYm91bmRzIG9ubHlcbiAgcmV0dXJuKGMoZGlmZi5tdSwgY2kuOTUkY29uZi5pbnRbMV0sIGNpLjk1JGNvbmYuaW50WzJdKSlcbn1cblxuXG5gYGAifQ== -->

```r
#choose a column (independent variable) - clump thickness [,1]
#For each df: random sample n=30  
#difference in sample means -compare against outcomes, 95% CI t-test.
fun1 <- function(ben.data, mal.data, column, smpl.size=30){
  #pull random sample from each outcome
  ben.smpl <- sample(na.omit(ben.data[[column]]), smpl.size, replace = T) #set to replace so that each sample is independent
  mal.smpl <- sample(na.omit(mal.data[[column]]), smpl.size, replace =T)
  
  #calc means
  ben.mu <- mean(ben.smpl)
  mal.mu <- mean(mal.smpl)
  
  #calc difference in means
  diff.mu <- mal.mu - ben.mu #based on quick view of means, malignant outcome is higher
  
  #perform t-test on difference in means
  ci.95 <- t.test(mal.smpl, ben.smpl, conf.level= 0.95)
 
  #return(list(diff.mu, ci.95)) #returns full t-test > try $conf.int
  #return(list(diff.mu, ci.95$conf.int)) #conf.int returns 3 items, try isolate lower and upper bounds only
  return(c(diff.mu, ci.95$conf.int[1], ci.95$conf.int[2]))
}

```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->

Check first instance (1 simulation) of function, output displayed as difference in sample means (between outcomes), lower bound of 95% confidence interval, higher bound:

<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVablZ1TVNoaVpXNHVaR0YwWVN3Z2JXRnNMbVJoZEdFc0lESXBYRzVnWUdBaWZRPT0gLS0+XG5cbmBgYHJcbmZ1bjEoYmVuLmRhdGEsIG1hbC5kYXRhLCAyKVxuYGBgXG5cbjwhLS0gcm5iLXNvdXJjZS1lbmQgLS0+XG4ifQ== -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZnVuMShiZW4uZGF0YSwgbWFsLmRhdGEsIDIpXG5gYGAifQ== -->

```r
fun1(ben.data, mal.data, 2)
```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->

Repeat 1000 times using replicate()

<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVZMmt1YldGMGNtbDRJRHd0SUhKbGNHeHBZMkYwWlNneE1EQXdMQ0JtZFc0eEtHSmxiaTVrWVhSaExDQnRZV3d1WkdGMFlTd2dYQ0pqYkhWdGNGOTBhR2xqYTI1bGMzTmNJaWtwWEc0amMybHRkV3hoZEdsdmJuTWdZWEpsSUdOdmJIVnRibk1zSUhSeVlXNXpjRzl6WlNCMGJ5QnRZV3RsSUhKdmQzTmNibU5wTG0xaGRISnBlQ0E4TFNCMEtHTnBMbTFoZEhKcGVDbGNibU52Ykc1aGJXVnpLR05wTG0xaGRISnBlQ2tnUEMwZ1l5aGNJbTExWDJScFptWmxjbVZ1WTJWY0lpd2dYQ0pzYjNkbGNsOWphVndpTENCY0luVndjR1Z5WDJOcFhDSXBYRzVrYVcwb1kya3ViV0YwY21sNEtWeHVJM0J5WlhacFpYZGNibU5wTG0xaGRISnBlRnN4T2pVc1hWeHVZR0JnSW4wPSAtLT5cblxuYGBgclxuY2kubWF0cml4IDwtIHJlcGxpY2F0ZSgxMDAwLCBmdW4xKGJlbi5kYXRhLCBtYWwuZGF0YSwgXCJjbHVtcF90aGlja25lc3NcIikpXG4jc2ltdWxhdGlvbnMgYXJlIGNvbHVtbnMsIHRyYW5zcG9zZSB0byBtYWtlIHJvd3NcbmNpLm1hdHJpeCA8LSB0KGNpLm1hdHJpeClcbmNvbG5hbWVzKGNpLm1hdHJpeCkgPC0gYyhcIm11X2RpZmZlcmVuY2VcIiwgXCJsb3dlcl9jaVwiLCBcInVwcGVyX2NpXCIpXG5kaW0oY2kubWF0cml4KVxuI3ByZXZpZXdcbmNpLm1hdHJpeFsxOjUsXVxuYGBgXG5cbjwhLS0gcm5iLXNvdXJjZS1lbmQgLS0+XG4ifQ== -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY2kubWF0cml4IDwtIHJlcGxpY2F0ZSgxMDAwLCBmdW4xKGJlbi5kYXRhLCBtYWwuZGF0YSwgXCJjbHVtcF90aGlja25lc3NcIikpXG4jc2ltdWxhdGlvbnMgYXJlIGNvbHVtbnMsIHRyYW5zcG9zZSB0byBtYWtlIHJvd3NcbmNpLm1hdHJpeCA8LSB0KGNpLm1hdHJpeClcbmNvbG5hbWVzKGNpLm1hdHJpeCkgPC0gYyhcIm11X2RpZmZlcmVuY2VcIiwgXCJsb3dlcl9jaVwiLCBcInVwcGVyX2NpXCIpXG5kaW0oY2kubWF0cml4KVxuI3ByZXZpZXdcbmNpLm1hdHJpeFsxOjUsXVxuYGBgIn0= -->

```r
ci.matrix <- replicate(1000, fun1(ben.data, mal.data, "clump_thickness"))
#simulations are columns, transpose to make rows
ci.matrix <- t(ci.matrix)
colnames(ci.matrix) <- c("mu_difference", "lower_ci", "upper_ci")
dim(ci.matrix)
#preview
ci.matrix[1:5,]
```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->


> Then calculate: a. The average length of the confidence interval. b. The population level difference (e.g. the difference between the means) c. How often the confidence intervals contain the population level difference Repeat this analysis for the rest of the columns in the data set and describe the results.


<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVablZ1TWlBOExTQm1kVzVqZEdsdmJpaGphUzV0WVhSeWFYZ3BJSHRjYmlBZ0l5QkJkbVZ5WVdkbElHeGxibWQwYUNCdlppQmphVnh1SUNCamFTNXNaVzVuZEdndWJYVWdQQzBnYldWaGJpaGphUzV0WVhSeWFYaGJMQ0JjSW5Wd2NHVnlYMk5wWENKZElDMGdZMmt1YldGMGNtbDRXeXdnWENKc2IzZGxjbDlqYVZ3aVhTbGNiaUFnSXlCUWIzQjFiR0YwYVc5dUlHeGxkbVZzSUdScFptWmxjbVZ1WTJVZ0tHRjJaWEpoWjJVZ2IyWWdkR2hsSUdScFptWmxjbVZ1WTJWeklHWnliMjBnWldGamFDQnphVzExYkdGMGFXOXVLVnh1SUNCd2IzQXVaR2xtWm1WeVpXNWpaU0E4TFNCdFpXRnVLR05wTG0xaGRISnBlRnNzSUZ3aWJYVmZaR2xtWm1WeVpXNWpaVndpWFNsY2JpQWdJeUJJYjNjZ2IyWjBaVzRnWkc5bGN5QjBhR1VnUTBrZ2FXNWpiSFZrWlNCMGFHVWdaWE4wYVcxaGRHVmtJSEJ2Y0NCa2FXWm1aWEpsYm1ObFAxeHVJQ0J3YjNCa2FXWm1MbWx1TG1OcElEd3RJSE4xYlNoamFTNXRZWFJ5YVhoYkxDQmNJbXh2ZDJWeVgyTnBYQ0pkSUR3OUlIQnZjQzVrYVdabVpYSmxibU5sSUNZZ1kya3ViV0YwY21sNFd5d2dYQ0oxY0hCbGNsOWphVndpWFNBK1BTQndiM0F1WkdsbVptVnlaVzVqWlNrZ0x5QnVjbTkzS0dOcExtMWhkSEpwZUNrZ0tpQXhNREJjYmlBZ1hHNGdJSEpsZEhWeWJpaHNhWE4wS0dOcFgyeGxibWQwYUNBOUlHTnBMbXhsYm1kMGFDNXRkU3dnY0c5d1gyUnBabVlnUFNCd2IzQXVaR2xtWm1WeVpXNWpaU3dnY0dOMFgybHVYME5KSUQwZ2NHOXdaR2xtWmk1cGJpNWphU2twWEc1OVhHNWNibVoxYmpJb1kya3ViV0YwY21sNEtWeHVZR0JnSW4wPSAtLT5cblxuYGBgclxuZnVuMiA8LSBmdW5jdGlvbihjaS5tYXRyaXgpIHtcbiAgIyBBdmVyYWdlIGxlbmd0aCBvZiBjaVxuICBjaS5sZW5ndGgubXUgPC0gbWVhbihjaS5tYXRyaXhbLCBcInVwcGVyX2NpXCJdIC0gY2kubWF0cml4WywgXCJsb3dlcl9jaVwiXSlcbiAgIyBQb3B1bGF0aW9uIGxldmVsIGRpZmZlcmVuY2UgKGF2ZXJhZ2Ugb2YgdGhlIGRpZmZlcmVuY2VzIGZyb20gZWFjaCBzaW11bGF0aW9uKVxuICBwb3AuZGlmZmVyZW5jZSA8LSBtZWFuKGNpLm1hdHJpeFssIFwibXVfZGlmZmVyZW5jZVwiXSlcbiAgIyBIb3cgb2Z0ZW4gZG9lcyB0aGUgQ0kgaW5jbHVkZSB0aGUgZXN0aW1hdGVkIHBvcCBkaWZmZXJlbmNlP1xuICBwb3BkaWZmLmluLmNpIDwtIHN1bShjaS5tYXRyaXhbLCBcImxvd2VyX2NpXCJdIDw9IHBvcC5kaWZmZXJlbmNlICYgY2kubWF0cml4WywgXCJ1cHBlcl9jaVwiXSA+PSBwb3AuZGlmZmVyZW5jZSkgLyBucm93KGNpLm1hdHJpeCkgKiAxMDBcbiAgXG4gIHJldHVybihsaXN0KGNpX2xlbmd0aCA9IGNpLmxlbmd0aC5tdSwgcG9wX2RpZmYgPSBwb3AuZGlmZmVyZW5jZSwgcGN0X2luX0NJID0gcG9wZGlmZi5pbi5jaSkpXG59XG5cbmZ1bjIoY2kubWF0cml4KVxuYGBgXG5cbjwhLS0gcm5iLXNvdXJjZS1lbmQgLS0+XG4ifQ== -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZnVuMiA8LSBmdW5jdGlvbihjaS5tYXRyaXgpIHtcbiAgIyBBdmVyYWdlIGxlbmd0aCBvZiBjaVxuICBjaS5sZW5ndGgubXUgPC0gbWVhbihjaS5tYXRyaXhbLCBcInVwcGVyX2NpXCJdIC0gY2kubWF0cml4WywgXCJsb3dlcl9jaVwiXSlcbiAgIyBQb3B1bGF0aW9uIGxldmVsIGRpZmZlcmVuY2UgKGF2ZXJhZ2Ugb2YgdGhlIGRpZmZlcmVuY2VzIGZyb20gZWFjaCBzaW11bGF0aW9uKVxuICBwb3AuZGlmZmVyZW5jZSA8LSBtZWFuKGNpLm1hdHJpeFssIFwibXVfZGlmZmVyZW5jZVwiXSlcbiAgIyBIb3cgb2Z0ZW4gZG9lcyB0aGUgQ0kgaW5jbHVkZSB0aGUgZXN0aW1hdGVkIHBvcCBkaWZmZXJlbmNlP1xuICBwb3BkaWZmLmluLmNpIDwtIHN1bShjaS5tYXRyaXhbLCBcImxvd2VyX2NpXCJdIDw9IHBvcC5kaWZmZXJlbmNlICYgY2kubWF0cml4WywgXCJ1cHBlcl9jaVwiXSA+PSBwb3AuZGlmZmVyZW5jZSkgLyBucm93KGNpLm1hdHJpeCkgKiAxMDBcbiAgXG4gIHJldHVybihsaXN0KGNpX2xlbmd0aCA9IGNpLmxlbmd0aC5tdSwgcG9wX2RpZmYgPSBwb3AuZGlmZmVyZW5jZSwgcGN0X2luX0NJID0gcG9wZGlmZi5pbi5jaSkpXG59XG5cbmZ1bjIoY2kubWF0cml4KVxuYGBgIn0= -->

```r
fun2 <- function(ci.matrix) {
  # Average length of ci
  ci.length.mu <- mean(ci.matrix[, "upper_ci"] - ci.matrix[, "lower_ci"])
  # Population level difference (average of the differences from each simulation)
  pop.difference <- mean(ci.matrix[, "mu_difference"])
  # How often does the CI include the estimated pop difference?
  popdiff.in.ci <- sum(ci.matrix[, "lower_ci"] <= pop.difference & ci.matrix[, "upper_ci"] >= pop.difference) / nrow(ci.matrix) * 100
  
  return(list(ci_length = ci.length.mu, pop_diff = pop.difference, pct_in_CI = popdiff.in.ci))
}

fun2(ci.matrix)
```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->

Repeat for all columns:


<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVJMlJoZEdFZ1puSmhiV1VnZEc4Z2MzUnZjbVVnYzNSaGRITWdabTl5SUdWaFkyZ2dZMjlzZFcxdVhHNWpiMngxYlc0dWMzUmhkSE1nUEMwZ1pHRjBZUzVtY21GdFpTaGpiMngxYlc1ZmJtRnRaU0E5SUdOb1lYSmhZM1JsY2lncExDQmhkbWRmWTJsZmJHVnVaM1JvUFNCdWRXMWxjbWxqS0Nrc0lIQnZjRjlzWlhabGJGOWthV1ptWlhKbGJtTmxQU0J1ZFcxbGNtbGpLQ2tzSUhCbGNtTmxiblJmYVc1ZlkyazlJRzUxYldWeWFXTW9LU2xjYmx4dUkyTnlaV0YwWlNCbGJYQjBlU0JzYVhOMElIUnZJSE4wYjNKbElITmhiWEJzWlNCa1lYUmhJR1p2Y2lCc1lYUmxjbHh1YzJGdGNHeGxMbTFoZEhKcFkyVnpJRHd0SUd4cGMzUW9LVnh1WEc1bWIzSWdLR052YkhWdGJpNXBJR2x1SUdOdmJHNWhiV1Z6S0dSaGRHRXVkR0pzS1ZzeU9qRXdYU2w3WEc0Z0lHTnZiQzVqYVM1dFlYUnlhWGdnUEMwZ2NtVndiR2xqWVhSbEtERXdNREFzSUdaMWJqRW9ZbVZ1TG1SaGRHRXNJRzFoYkM1a1lYUmhMQ0JqYjJ4MWJXNHVhU2twWEc0Z0lHTnZiQzVqYVM1dFlYUnlhWGdnUEMwZ2RDaGpiMnd1WTJrdWJXRjBjbWw0S1Z4dUlDQmpiMnh1WVcxbGN5aGpiMnd1WTJrdWJXRjBjbWw0S1NBOExTQmpLRndpYlhWZlpHbG1abVZ5Wlc1alpWd2lMQ0JjSW14dmQyVnlYMk5wWENJc0lGd2lkWEJ3WlhKZlkybGNJaWxjYmlBZ1hHNGdJQ056ZEc5eVpTQnRZWFJ5YVhnZ2FXNGdkR2hsSUd4cGMzUWdabTl5SUd4aGRHVnlJSFZ6WlNBb2RHOGdZMjl0Y0dGeVpTQmhaMkZwYm5OMElIQnZjSFZzWVhScGIyNGdaR0YwWVNsY2JpQWdjMkZ0Y0d4bExtMWhkSEpwWTJWelcxdGpiMngxYlc0dWFWMWRJRHd0SUdOdmJDNWphUzV0WVhSeWFYaGNiaUFnWEc0Z0lDTmpZV3hqZFd4aGRHVWdjM1Z0YldGeWVTQnpkR0YwY3l3Z1lXUmtJSFJ2SUdSbVhHNGdJR05oYkdOMWJHRjBhVzl1Y3lBOExTQm1kVzR5S0dOdmJDNWphUzV0WVhSeWFYZ3BYRzRnSUhKdmR5NWtaaUE4TFNCa1lYUmhMbVp5WVcxbEtHTnZiSFZ0Ymw5dVlXMWxQU0JqYjJ4MWJXNHVhU3hoZG1kZlkybGZiR1Z1WjNSb1BTQmpZV3hqZFd4aGRHbHZibk1rWTJsZmJHVnVaM1JvTENCd2IzQmZiR1YyWld4ZlpHbG1abVZ5Wlc1alpUMGdZMkZzWTNWc1lYUnBiMjV6SkhCdmNGOWthV1ptTENCd1pYSmpaVzUwWDJsdVgyTnBQU0JqWVd4amRXeGhkR2x2Ym5Na2NHTjBYMmx1WDBOSktWeHVJQ0FqWW1sdVpDQnVaWGNnY205M0lIUnZJR052YkhWdGJpNXpkR0YwYzF4dUlDQmpiMngxYlc0dWMzUmhkSE1nUEMwZ2NtSnBibVFvWTI5c2RXMXVMbk4wWVhSekxDQnliM2N1WkdZcFhHNTlYRzVqYjJ4MWJXNHVjM1JoZEhOY2JtQmdZQ0o5IC0tPlxuXG5gYGByXG4jZGF0YSBmcmFtZSB0byBzdG9yZSBzdGF0cyBmb3IgZWFjaCBjb2x1bW5cbmNvbHVtbi5zdGF0cyA8LSBkYXRhLmZyYW1lKGNvbHVtbl9uYW1lID0gY2hhcmFjdGVyKCksIGF2Z19jaV9sZW5ndGg9IG51bWVyaWMoKSwgcG9wX2xldmVsX2RpZmZlcmVuY2U9IG51bWVyaWMoKSwgcGVyY2VudF9pbl9jaT0gbnVtZXJpYygpKVxuXG4jY3JlYXRlIGVtcHR5IGxpc3QgdG8gc3RvcmUgc2FtcGxlIGRhdGEgZm9yIGxhdGVyXG5zYW1wbGUubWF0cmljZXMgPC0gbGlzdCgpXG5cbmZvciAoY29sdW1uLmkgaW4gY29sbmFtZXMoZGF0YS50YmwpWzI6MTBdKXtcbiAgY29sLmNpLm1hdHJpeCA8LSByZXBsaWNhdGUoMTAwMCwgZnVuMShiZW4uZGF0YSwgbWFsLmRhdGEsIGNvbHVtbi5pKSlcbiAgY29sLmNpLm1hdHJpeCA8LSB0KGNvbC5jaS5tYXRyaXgpXG4gIGNvbG5hbWVzKGNvbC5jaS5tYXRyaXgpIDwtIGMoXCJtdV9kaWZmZXJlbmNlXCIsIFwibG93ZXJfY2lcIiwgXCJ1cHBlcl9jaVwiKVxuICBcbiAgI3N0b3JlIG1hdHJpeCBpbiB0aGUgbGlzdCBmb3IgbGF0ZXIgdXNlICh0byBjb21wYXJlIGFnYWluc3QgcG9wdWxhdGlvbiBkYXRhKVxuICBzYW1wbGUubWF0cmljZXNbW2NvbHVtbi5pXV0gPC0gY29sLmNpLm1hdHJpeFxuICBcbiAgI2NhbGN1bGF0ZSBzdW1tYXJ5IHN0YXRzLCBhZGQgdG8gZGZcbiAgY2FsY3VsYXRpb25zIDwtIGZ1bjIoY29sLmNpLm1hdHJpeClcbiAgcm93LmRmIDwtIGRhdGEuZnJhbWUoY29sdW1uX25hbWU9IGNvbHVtbi5pLGF2Z19jaV9sZW5ndGg9IGNhbGN1bGF0aW9ucyRjaV9sZW5ndGgsIHBvcF9sZXZlbF9kaWZmZXJlbmNlPSBjYWxjdWxhdGlvbnMkcG9wX2RpZmYsIHBlcmNlbnRfaW5fY2k9IGNhbGN1bGF0aW9ucyRwY3RfaW5fQ0kpXG4gICNiaW5kIG5ldyByb3cgdG8gY29sdW1uLnN0YXRzXG4gIGNvbHVtbi5zdGF0cyA8LSByYmluZChjb2x1bW4uc3RhdHMsIHJvdy5kZilcbn1cbmNvbHVtbi5zdGF0c1xuYGBgXG5cbjwhLS0gcm5iLXNvdXJjZS1lbmQgLS0+XG4ifQ== -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuI2RhdGEgZnJhbWUgdG8gc3RvcmUgc3RhdHMgZm9yIGVhY2ggY29sdW1uXG5jb2x1bW4uc3RhdHMgPC0gZGF0YS5mcmFtZShjb2x1bW5fbmFtZSA9IGNoYXJhY3RlcigpLCBhdmdfY2lfbGVuZ3RoPSBudW1lcmljKCksIHBvcF9sZXZlbF9kaWZmZXJlbmNlPSBudW1lcmljKCksIHBlcmNlbnRfaW5fY2k9IG51bWVyaWMoKSlcblxuI2NyZWF0ZSBlbXB0eSBsaXN0IHRvIHN0b3JlIHNhbXBsZSBkYXRhIGZvciBsYXRlclxuc2FtcGxlLm1hdHJpY2VzIDwtIGxpc3QoKVxuXG5mb3IgKGNvbHVtbi5pIGluIGNvbG5hbWVzKGRhdGEudGJsKVsyOjEwXSl7XG4gIGNvbC5jaS5tYXRyaXggPC0gcmVwbGljYXRlKDEwMDAsIGZ1bjEoYmVuLmRhdGEsIG1hbC5kYXRhLCBjb2x1bW4uaSkpXG4gIGNvbC5jaS5tYXRyaXggPC0gdChjb2wuY2kubWF0cml4KVxuICBjb2xuYW1lcyhjb2wuY2kubWF0cml4KSA8LSBjKFwibXVfZGlmZmVyZW5jZVwiLCBcImxvd2VyX2NpXCIsIFwidXBwZXJfY2lcIilcbiAgXG4gICNzdG9yZSBtYXRyaXggaW4gdGhlIGxpc3QgZm9yIGxhdGVyIHVzZSAodG8gY29tcGFyZSBhZ2FpbnN0IHBvcHVsYXRpb24gZGF0YSlcbiAgc2FtcGxlLm1hdHJpY2VzW1tjb2x1bW4uaV1dIDwtIGNvbC5jaS5tYXRyaXhcbiAgXG4gICNjYWxjdWxhdGUgc3VtbWFyeSBzdGF0cywgYWRkIHRvIGRmXG4gIGNhbGN1bGF0aW9ucyA8LSBmdW4yKGNvbC5jaS5tYXRyaXgpXG4gIHJvdy5kZiA8LSBkYXRhLmZyYW1lKGNvbHVtbl9uYW1lPSBjb2x1bW4uaSxhdmdfY2lfbGVuZ3RoPSBjYWxjdWxhdGlvbnMkY2lfbGVuZ3RoLCBwb3BfbGV2ZWxfZGlmZmVyZW5jZT0gY2FsY3VsYXRpb25zJHBvcF9kaWZmLCBwZXJjZW50X2luX2NpPSBjYWxjdWxhdGlvbnMkcGN0X2luX0NJKVxuICAjYmluZCBuZXcgcm93IHRvIGNvbHVtbi5zdGF0c1xuICBjb2x1bW4uc3RhdHMgPC0gcmJpbmQoY29sdW1uLnN0YXRzLCByb3cuZGYpXG59XG5jb2x1bW4uc3RhdHNcbmBgYCJ9 -->

```r
#data frame to store stats for each column
column.stats <- data.frame(column_name = character(), avg_ci_length= numeric(), pop_level_difference= numeric(), percent_in_ci= numeric())

#create empty list to store sample data for later
sample.matrices <- list()

for (column.i in colnames(data.tbl)[2:10]){
  col.ci.matrix <- replicate(1000, fun1(ben.data, mal.data, column.i))
  col.ci.matrix <- t(col.ci.matrix)
  colnames(col.ci.matrix) <- c("mu_difference", "lower_ci", "upper_ci")
  
  #store matrix in the list for later use (to compare against population data)
  sample.matrices[[column.i]] <- col.ci.matrix
  
  #calculate summary stats, add to df
  calculations <- fun2(col.ci.matrix)
  row.df <- data.frame(column_name= column.i,avg_ci_length= calculations$ci_length, pop_level_difference= calculations$pop_diff, percent_in_ci= calculations$pct_in_CI)
  #bind new row to column.stats
  column.stats <- rbind(column.stats, row.df)
}
column.stats
```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->

**DESCRIBE RESULTS** 

>Next, calculate the confidence interval of the entire set of samples and compare it to by the randomly samples confidence intervals. A visual representation might be nice here which illustrates the confidence interval of the entire dataset relative to the randomly sampled confidence intervals


<!-- rnb-text-end -->



<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVjRzl3WDNaelgzTmhiWEJzWlY5d2JHOTBjeUE4TFNCbWRXNWpkR2x2YmloellXMXdiR1V1YldGMGNtbGpaWE1zSUdKbGJpNWtZWFJoTENCdFlXd3VaR0YwWVN3Z1kyOXNkVzF1S1h0Y2JpQWdJMkZ6YzJsbmJpQmpiM0p5WldOMElERXdNREI0TXlCdFlYUnlhWGdnWm05eUlHTnZiSFZ0YmlCbWNtOXRJSFJvWlNCc2FYTjBYRzRnSUhSdGNDNXRZWFJ5YVhnZ1BDMGdjMkZ0Y0d4bExtMWhkSEpwWTJWelcxdGpiMngxYlc1ZFhWeHVYRzRnSUZ4dUlDQWpkQzEwWlhOMElHVnVkR2x5WlNCamIyeDFiVzRnS0hCdmNIVnNZWFJwYjI0Z1pHRjBZU2xjYmlBZ1puVnNiQzUwZEdWemRDQThMU0IwTG5SbGMzUW9iV0ZzTG1SaGRHRmJXMk52YkhWdGJsMWRMQ0JpWlc0dVpHRjBZVnRiWTI5c2RXMXVYVjBzSUdOdmJtWXViR1YyWld3Z1BTQXdMamsxS1Z4dUlDQm1kV3hzTG1OcElEd3RJR1oxYkd3dWRIUmxjM1FrWTI5dVppNXBiblJjYmlBZ1puVnNiQzVrYVdabUlEd3RJR1oxYkd3dWRIUmxjM1FrWlhOMGFXMWhkR1ZiTVYwZ0xTQm1kV3hzTG5SMFpYTjBKR1Z6ZEdsdFlYUmxXekpkSUNBalpYTjBhVzFoZEdVZ2NIVnNiSE1nYldWaGJuTWdabkp2YlNCMllYSllLRzFoYkdsbmJtRnVkQ2tnZG1GeWVTaGlaVzVwWjI0cFhHNGdJRnh1SUNBalpHVm1hVzVsSUhCc2IzUWdiR2x0YVhSelhHNGdJSGxmY21GdVoyVWdQQzBnY21GdVoyVW9ZeWgwYlhBdWJXRjBjbWw0V3l3Z1hDSnNiM2RsY2w5amFWd2lYU3dnZEcxd0xtMWhkSEpwZUZzc0lGd2lkWEJ3WlhKZlkybGNJbDBzSUdaMWJHd3VZMmtwS1NBalkyOTFiR1FnWVd4emJ5QjFjMlVnYldGNFAxeHVJQ0J3Ykc5MEtERTZNVEF3TUN3Z01Ub3hNREF3TENCMGVYQmxJRDBnWENKdVhDSXNYRzRnSUNBZ0lDQWdlR3hoWWlBOUlGd2liaUF4TURBd0lITnBiWE5jSWl3Z2VXeGhZaUE5SUZ3aVRXVmhiaUJFYVdabVpYSmxibU5sWENJc1hHNGdJQ0FnSUNBZ2VXeHBiU0E5SUhsZmNtRnVaMlVzWEc0Z0lDQWdJQ0FnYldGcGJpQTlJSEJoYzNSbEtGd2lVMmx0ZFd4aGRHVmtJRU52Ym1acFpHVnVZMlVnU1c1MFpYSjJZV3h6SUdadmNsd2lMQ0JqYjJ4MWJXNHBLVnh1SUNBamNHeHZkQ0JsWVdOb0lHbHBaQ2R6SUdOdmJtWnBaR1Z1WTJVZ2FXNTBaWEoyWVd3Z1lYTWdZU0IyWlhKMGFXTmhiQ0JzYVc1bFhHNGdJR1p2Y2lBb2FTQnBiaUF4T2pFd01EQXBJSHRjYmlBZ0lDQnpaV2R0Wlc1MGN5aDRNQ0E5SUdrc0lIZ3hJRDBnYVN3Z1hHNGdJQ0FnSUNBZ0lDQWdJQ0FnZVRBZ1BTQjBiWEF1YldGMGNtbDRXMmtzSUZ3aWJHOTNaWEpmWTJsY0lsMHNJRnh1SUNBZ0lDQWdJQ0FnSUNBZ0lIa3hJRDBnZEcxd0xtMWhkSEpwZUZ0cExDQmNJblZ3Y0dWeVgyTnBYQ0pkTEZ4dUlDQWdJQ0FnSUNBZ0lDQWdJR052YkNBOUlISm5ZaWd3TENBd0xDQXhMQ0JoYkhCb1lTQTlJREF1TXlrcFhHNGdJSDFjYmlBZ1hHNGdJQ01nWVdSa0lHVmhZMmdnYVM1cExtUW5jeUJ0WldGdUlHUnBabVpsY21WdVkyVnpJR0Z6SUhCdmFXNTBjeTVjYmlBZ2NHOXBiblJ6S0RFNk1UQXdNQ3dnZEcxd0xtMWhkSEpwZUZzc0lGd2liWFZmWkdsbVptVnlaVzVqWlZ3aVhTd2djR05vSUQwZ01UWXNJR052YkNBOUlISm5ZaWd3TENBd0xDQXhMQ0JoYkhCb1lTQTlJREF1TlNrcFhHNGdJRnh1SUNBamJHbHVaWE1nWm05eUlIUm9aU0JpYjNWdVpITWdiMllnZEdobElIQnZjSFZzWVhScGIyNGdRMGxjYmlBZ1lXSnNhVzVsS0dnZ1BTQm1kV3hzTG1OcFd6RmRMQ0JqYjJ3Z1BTQmNJbkpsWkZ3aUxDQnNkSGtnUFNBeUxDQnNkMlFnUFNBeUtWeHVJQ0JoWW14cGJtVW9hQ0E5SUdaMWJHd3VZMmxiTWwwc0lHTnZiQ0E5SUZ3aWNtVmtYQ0lzSUd4MGVTQTlJRElzSUd4M1pDQTlJRElwWEc0Z0lDTnNhVzVsSUdadmNpQjBhR1VnY0c5d2RXeGhkR2x2YmlCdFpXRnVJR1JwWm1aY2JpQWdZV0pzYVc1bEtHZ2dQU0JtZFd4c0xtUnBabVlzSUdOdmJDQTlJRndpWjNKbFpXNWNJaXdnYkhka0lEMGdNaWxjYmlBZ1hHNGdJQ01nWVdSa0lHRWdiR1ZuWlc1a1hHNGdJR3hsWjJWdVpDaGNJblJ2Y0hKcFoyaDBYQ0lzWEc0Z0lDQWdJQ0FnSUNCc1pXZGxibVFnUFNCaktGd2lSR2xtWm1WeVpXNWpaU0JwYmlCemJYQnNJRzFsWVc1elhDSXNJRndpVTJGdGNHeGxJRU5KSjNOY0lpd2dYQ0pRYjNCMWJHRjBhVzl1SUVOSlhDSXNJRndpUkdsbVptVnlaVzVqWlNCcGJpQndiM0FnYldWaGJsd2lLU3dnWTI5c0lEMGdZeWh5WjJJb01Dd2dNQ3dnTVN3Z1lXeHdhR0VnUFNBd0xqVXBMSEpuWWlnd0xDQXdMQ0F4TENCaGJIQm9ZU0E5SURBdU15a3NJRndpY21Wa1hDSXNJRndpWjNKbFpXNWNJaWtzYkhSNUlEMGdZeWhPUVN3Z01Td2dNaXdnTVNrc0lIQmphQ0E5SUdNb01UWXNJRTVCTENCT1FTd2dUa0VwTENCalpYZzlNQzQxS1Z4dWZWeHVJQ0JjYmx4dVlHQmdJbjA9IC0tPlxuXG5gYGByXG5wb3BfdnNfc2FtcGxlX3Bsb3RzIDwtIGZ1bmN0aW9uKHNhbXBsZS5tYXRyaWNlcywgYmVuLmRhdGEsIG1hbC5kYXRhLCBjb2x1bW4pe1xuICAjYXNzaWduIGNvcnJlY3QgMTAwMHgzIG1hdHJpeCBmb3IgY29sdW1uIGZyb20gdGhlIGxpc3RcbiAgdG1wLm1hdHJpeCA8LSBzYW1wbGUubWF0cmljZXNbW2NvbHVtbl1dXG5cbiAgXG4gICN0LXRlc3QgZW50aXJlIGNvbHVtbiAocG9wdWxhdGlvbiBkYXRhKVxuICBmdWxsLnR0ZXN0IDwtIHQudGVzdChtYWwuZGF0YVtbY29sdW1uXV0sIGJlbi5kYXRhW1tjb2x1bW5dXSwgY29uZi5sZXZlbCA9IDAuOTUpXG4gIGZ1bGwuY2kgPC0gZnVsbC50dGVzdCRjb25mLmludFxuICBmdWxsLmRpZmYgPC0gZnVsbC50dGVzdCRlc3RpbWF0ZVsxXSAtIGZ1bGwudHRlc3QkZXN0aW1hdGVbMl0gICNlc3RpbWF0ZSBwdWxscyBtZWFucyBmcm9tIHZhclgobWFsaWduYW50KSB2YXJ5KGJlbmlnbilcbiAgXG4gICNkZWZpbmUgcGxvdCBsaW1pdHNcbiAgeV9yYW5nZSA8LSByYW5nZShjKHRtcC5tYXRyaXhbLCBcImxvd2VyX2NpXCJdLCB0bXAubWF0cml4WywgXCJ1cHBlcl9jaVwiXSwgZnVsbC5jaSkpICNjb3VsZCBhbHNvIHVzZSBtYXg/XG4gIHBsb3QoMToxMDAwLCAxOjEwMDAsIHR5cGUgPSBcIm5cIixcbiAgICAgICB4bGFiID0gXCJuIDEwMDAgc2ltc1wiLCB5bGFiID0gXCJNZWFuIERpZmZlcmVuY2VcIixcbiAgICAgICB5bGltID0geV9yYW5nZSxcbiAgICAgICBtYWluID0gcGFzdGUoXCJTaW11bGF0ZWQgQ29uZmlkZW5jZSBJbnRlcnZhbHMgZm9yXCIsIGNvbHVtbikpXG4gICNwbG90IGVhY2ggaWlkJ3MgY29uZmlkZW5jZSBpbnRlcnZhbCBhcyBhIHZlcnRpY2FsIGxpbmVcbiAgZm9yIChpIGluIDE6MTAwMCkge1xuICAgIHNlZ21lbnRzKHgwID0gaSwgeDEgPSBpLCBcbiAgICAgICAgICAgICB5MCA9IHRtcC5tYXRyaXhbaSwgXCJsb3dlcl9jaVwiXSwgXG4gICAgICAgICAgICAgeTEgPSB0bXAubWF0cml4W2ksIFwidXBwZXJfY2lcIl0sXG4gICAgICAgICAgICAgY29sID0gcmdiKDAsIDAsIDEsIGFscGhhID0gMC4zKSlcbiAgfVxuICBcbiAgIyBhZGQgZWFjaCBpLmkuZCdzIG1lYW4gZGlmZmVyZW5jZXMgYXMgcG9pbnRzLlxuICBwb2ludHMoMToxMDAwLCB0bXAubWF0cml4WywgXCJtdV9kaWZmZXJlbmNlXCJdLCBwY2ggPSAxNiwgY29sID0gcmdiKDAsIDAsIDEsIGFscGhhID0gMC41KSlcbiAgXG4gICNsaW5lcyBmb3IgdGhlIGJvdW5kcyBvZiB0aGUgcG9wdWxhdGlvbiBDSVxuICBhYmxpbmUoaCA9IGZ1bGwuY2lbMV0sIGNvbCA9IFwicmVkXCIsIGx0eSA9IDIsIGx3ZCA9IDIpXG4gIGFibGluZShoID0gZnVsbC5jaVsyXSwgY29sID0gXCJyZWRcIiwgbHR5ID0gMiwgbHdkID0gMilcbiAgI2xpbmUgZm9yIHRoZSBwb3B1bGF0aW9uIG1lYW4gZGlmZlxuICBhYmxpbmUoaCA9IGZ1bGwuZGlmZiwgY29sID0gXCJncmVlblwiLCBsd2QgPSAyKVxuICBcbiAgIyBhZGQgYSBsZWdlbmRcbiAgbGVnZW5kKFwidG9wcmlnaHRcIixcbiAgICAgICAgIGxlZ2VuZCA9IGMoXCJEaWZmZXJlbmNlIGluIHNtcGwgbWVhbnNcIiwgXCJTYW1wbGUgQ0knc1wiLCBcIlBvcHVsYXRpb24gQ0lcIiwgXCJEaWZmZXJlbmNlIGluIHBvcCBtZWFuXCIpLCBjb2wgPSBjKHJnYigwLCAwLCAxLCBhbHBoYSA9IDAuNSkscmdiKDAsIDAsIDEsIGFscGhhID0gMC4zKSwgXCJyZWRcIiwgXCJncmVlblwiKSxsdHkgPSBjKE5BLCAxLCAyLCAxKSwgcGNoID0gYygxNiwgTkEsIE5BLCBOQSksIGNleD0wLjUpXG59XG4gIFxuXG5gYGBcblxuPCEtLSBybmItc291cmNlLWVuZCAtLT5cbiJ9 -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucG9wX3ZzX3NhbXBsZV9wbG90cyA8LSBmdW5jdGlvbihzYW1wbGUubWF0cmljZXMsIGJlbi5kYXRhLCBtYWwuZGF0YSwgY29sdW1uKXtcbiAgI2Fzc2lnbiBjb3JyZWN0IDEwMDB4MyBtYXRyaXggZm9yIGNvbHVtbiBmcm9tIHRoZSBsaXN0XG4gIHRtcC5tYXRyaXggPC0gc2FtcGxlLm1hdHJpY2VzW1tjb2x1bW5dXVxuXG4gIFxuICAjdC10ZXN0IGVudGlyZSBjb2x1bW4gKHBvcHVsYXRpb24gZGF0YSlcbiAgZnVsbC50dGVzdCA8LSB0LnRlc3QobWFsLmRhdGFbW2NvbHVtbl1dLCBiZW4uZGF0YVtbY29sdW1uXV0sIGNvbmYubGV2ZWwgPSAwLjk1KVxuICBmdWxsLmNpIDwtIGZ1bGwudHRlc3QkY29uZi5pbnRcbiAgZnVsbC5kaWZmIDwtIGZ1bGwudHRlc3QkZXN0aW1hdGVbMV0gLSBmdWxsLnR0ZXN0JGVzdGltYXRlWzJdICAjZXN0aW1hdGUgcHVsbHMgbWVhbnMgZnJvbSB2YXJYKG1hbGlnbmFudCkgdmFyeShiZW5pZ24pXG4gIFxuICAjZGVmaW5lIHBsb3QgbGltaXRzXG4gIHlfcmFuZ2UgPC0gcmFuZ2UoYyh0bXAubWF0cml4WywgXCJsb3dlcl9jaVwiXSwgdG1wLm1hdHJpeFssIFwidXBwZXJfY2lcIl0sIGZ1bGwuY2kpKSAjY291bGQgYWxzbyB1c2UgbWF4P1xuICBwbG90KDE6MTAwMCwgMToxMDAwLCB0eXBlID0gXCJuXCIsXG4gICAgICAgeGxhYiA9IFwibiAxMDAwIHNpbXNcIiwgeWxhYiA9IFwiTWVhbiBEaWZmZXJlbmNlXCIsXG4gICAgICAgeWxpbSA9IHlfcmFuZ2UsXG4gICAgICAgbWFpbiA9IHBhc3RlKFwiU2ltdWxhdGVkIENvbmZpZGVuY2UgSW50ZXJ2YWxzIGZvclwiLCBjb2x1bW4pKVxuICAjcGxvdCBlYWNoIGlpZCdzIGNvbmZpZGVuY2UgaW50ZXJ2YWwgYXMgYSB2ZXJ0aWNhbCBsaW5lXG4gIGZvciAoaSBpbiAxOjEwMDApIHtcbiAgICBzZWdtZW50cyh4MCA9IGksIHgxID0gaSwgXG4gICAgICAgICAgICAgeTAgPSB0bXAubWF0cml4W2ksIFwibG93ZXJfY2lcIl0sIFxuICAgICAgICAgICAgIHkxID0gdG1wLm1hdHJpeFtpLCBcInVwcGVyX2NpXCJdLFxuICAgICAgICAgICAgIGNvbCA9IHJnYigwLCAwLCAxLCBhbHBoYSA9IDAuMykpXG4gIH1cbiAgXG4gICMgYWRkIGVhY2ggaS5pLmQncyBtZWFuIGRpZmZlcmVuY2VzIGFzIHBvaW50cy5cbiAgcG9pbnRzKDE6MTAwMCwgdG1wLm1hdHJpeFssIFwibXVfZGlmZmVyZW5jZVwiXSwgcGNoID0gMTYsIGNvbCA9IHJnYigwLCAwLCAxLCBhbHBoYSA9IDAuNSkpXG4gIFxuICAjbGluZXMgZm9yIHRoZSBib3VuZHMgb2YgdGhlIHBvcHVsYXRpb24gQ0lcbiAgYWJsaW5lKGggPSBmdWxsLmNpWzFdLCBjb2wgPSBcInJlZFwiLCBsdHkgPSAyLCBsd2QgPSAyKVxuICBhYmxpbmUoaCA9IGZ1bGwuY2lbMl0sIGNvbCA9IFwicmVkXCIsIGx0eSA9IDIsIGx3ZCA9IDIpXG4gICNsaW5lIGZvciB0aGUgcG9wdWxhdGlvbiBtZWFuIGRpZmZcbiAgYWJsaW5lKGggPSBmdWxsLmRpZmYsIGNvbCA9IFwiZ3JlZW5cIiwgbHdkID0gMilcbiAgXG4gICMgYWRkIGEgbGVnZW5kXG4gIGxlZ2VuZChcInRvcHJpZ2h0XCIsXG4gICAgICAgICBsZWdlbmQgPSBjKFwiRGlmZmVyZW5jZSBpbiBzbXBsIG1lYW5zXCIsIFwiU2FtcGxlIENJJ3NcIiwgXCJQb3B1bGF0aW9uIENJXCIsIFwiRGlmZmVyZW5jZSBpbiBwb3AgbWVhblwiKSwgY29sID0gYyhyZ2IoMCwgMCwgMSwgYWxwaGEgPSAwLjUpLHJnYigwLCAwLCAxLCBhbHBoYSA9IDAuMyksIFwicmVkXCIsIFwiZ3JlZW5cIiksbHR5ID0gYyhOQSwgMSwgMiwgMSksIHBjaCA9IGMoMTYsIE5BLCBOQSwgTkEpLCBjZXg9MC41KVxufVxuICBcblxuYGBgIn0= -->

```r
pop_vs_sample_plots <- function(sample.matrices, ben.data, mal.data, column){
  #assign correct 1000x3 matrix for column from the list
  tmp.matrix <- sample.matrices[[column]]

  
  #t-test entire column (population data)
  full.ttest <- t.test(mal.data[[column]], ben.data[[column]], conf.level = 0.95)
  full.ci <- full.ttest$conf.int
  full.diff <- full.ttest$estimate[1] - full.ttest$estimate[2]  #estimate pulls means from varX(malignant) vary(benign)
  
  #define plot limits
  y_range <- range(c(tmp.matrix[, "lower_ci"], tmp.matrix[, "upper_ci"], full.ci)) #could also use max?
  plot(1:1000, 1:1000, type = "n",
       xlab = "n 1000 sims", ylab = "Mean Difference",
       ylim = y_range,
       main = paste("Simulated Confidence Intervals for", column))
  #plot each iid's confidence interval as a vertical line
  for (i in 1:1000) {
    segments(x0 = i, x1 = i, 
             y0 = tmp.matrix[i, "lower_ci"], 
             y1 = tmp.matrix[i, "upper_ci"],
             col = rgb(0, 0, 1, alpha = 0.3))
  }
  
  # add each i.i.d's mean differences as points.
  points(1:1000, tmp.matrix[, "mu_difference"], pch = 16, col = rgb(0, 0, 1, alpha = 0.5))
  
  #lines for the bounds of the population CI
  abline(h = full.ci[1], col = "red", lty = 2, lwd = 2)
  abline(h = full.ci[2], col = "red", lty = 2, lwd = 2)
  #line for the population mean diff
  abline(h = full.diff, col = "green", lwd = 2)
  
  # add a legend
  legend("topright",
         legend = c("Difference in smpl means", "Sample CI's", "Population CI", "Difference in pop mean"), col = c(rgb(0, 0, 1, alpha = 0.5),rgb(0, 0, 1, alpha = 0.3), "red", "green"),lty = c(NA, 1, 2, 1), pch = c(16, NA, NA, NA), cex=0.5)
}
  

```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVJM0JsY21admNtMGdablZ1WTNScGIyNGdiMjRnWldGamFDQmpiMngxYlc1Y2JtWnZjaUFvWTI5c2RXMXVMbWtnYVc0Z1kyOXNibUZ0WlhNb1pHRjBZUzUwWW13cFd6STZNVEJkS1h0Y2JpQWdjRzl3WDNaelgzTmhiWEJzWlY5d2JHOTBjeWh6WVcxd2JHVXViV0YwY21salpYTXNZbVZ1TG1SaGRHRXNiV0ZzTG1SaGRHRXNJR052YkhWdGJpNXBLVnh1ZlZ4dVlHQmdJbjA9IC0tPlxuXG5gYGByXG4jcGVyZm9ybSBmdW5jdGlvbiBvbiBlYWNoIGNvbHVtblxuZm9yIChjb2x1bW4uaSBpbiBjb2xuYW1lcyhkYXRhLnRibClbMjoxMF0pe1xuICBwb3BfdnNfc2FtcGxlX3Bsb3RzKHNhbXBsZS5tYXRyaWNlcyxiZW4uZGF0YSxtYWwuZGF0YSwgY29sdW1uLmkpXG59XG5gYGBcblxuPCEtLSBybmItc291cmNlLWVuZCAtLT5cbiJ9 -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuI3BlcmZvcm0gZnVuY3Rpb24gb24gZWFjaCBjb2x1bW5cbmZvciAoY29sdW1uLmkgaW4gY29sbmFtZXMoZGF0YS50YmwpWzI6MTBdKXtcbiAgcG9wX3ZzX3NhbXBsZV9wbG90cyhzYW1wbGUubWF0cmljZXMsYmVuLmRhdGEsbWFsLmRhdGEsIGNvbHVtbi5pKVxufVxuYGBgIn0= -->

```r
#perform function on each column
for (column.i in colnames(data.tbl)[2:10]){
  pop_vs_sample_plots(sample.matrices,ben.data,mal.data, column.i)
}
```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->


___
> 2. Download a data set from GEO that contains a continuous variable annotation. Build linear models of the effect of gene expression for each gene on the continuous variable (the continuous variable is the dependent variable). Then calculate confidence intervals for each model (use confint(), no need to try to calculate the intervals manually). Order the genes by their relationship to the dependent variable (e.g. p-value) and plot the confidence interval values. Describe results in plain English. Next, return the gene with the greatest and lowest predictive relationship and return the confidence intervals for each one of these. Describe these results.


<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHViR2xpY21GeWVTaEhSVTl4ZFdWeWVTbGNibWRsYjJSaGRHRWdQQzBnSUdkbGRFZEZUeWhjSWtkVFJUSTNNamN5WENJc0lFZFRSVTFoZEhKcGVDQTlJRlJTVlVVcFhHNWxjMlYwSUR3dElHZGxiMlJoZEdGYld6RmRYVnh1WldSaGRHRWdQQzBnWlhod2NuTW9aWE5sZENrZ0kyVjRjSEpsYzNOcGIyNGdiV0YwY21sNFhHNXdhR1Z1YnlBOExTQndSR0YwWVNobGMyVjBLVnh1WEc0allYTnpZWGtnWkdGMFlTQW9aV1JoZEdFcElHbG1JSGR2Ym5RZ2JHOWhaQ0JoZENCM2IzSnJPbHh1STJkbGIyUmhkR0ZiVzF3aVIxTkZNamN5TnpKZmMyVnlhV1Z6WDIxaGRISnBlQzUwZUhRdVozcGNJbDFkUUdGemMyRjVSR0YwWVZ0YlhDSmxlSEJ5YzF3aVhWMWNibHh1WUdCZ0luMD0gLS0+XG5cbmBgYHJcbmxpYnJhcnkoR0VPcXVlcnkpXG5nZW9kYXRhIDwtICBnZXRHRU8oXCJHU0UyNzI3MlwiLCBHU0VNYXRyaXggPSBUUlVFKVxuZXNldCA8LSBnZW9kYXRhW1sxXV1cbmVkYXRhIDwtIGV4cHJzKGVzZXQpICNleHByZXNzaW9uIG1hdHJpeFxucGhlbm8gPC0gcERhdGEoZXNldClcblxuI2Fzc2F5IGRhdGEgKGVkYXRhKSBpZiB3b250IGxvYWQgYXQgd29yazpcbiNnZW9kYXRhW1tcIkdTRTI3MjcyX3Nlcmllc19tYXRyaXgudHh0Lmd6XCJdXUBhc3NheURhdGFbW1wiZXhwcnNcIl1dXG5cbmBgYFxuXG48IS0tIHJuYi1zb3VyY2UtZW5kIC0tPlxuIn0= -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxubGlicmFyeShHRU9xdWVyeSlcbmdlb2RhdGEgPC0gIGdldEdFTyhcIkdTRTI3MjcyXCIsIEdTRU1hdHJpeCA9IFRSVUUpXG5lc2V0IDwtIGdlb2RhdGFbWzFdXVxuZWRhdGEgPC0gZXhwcnMoZXNldCkgI2V4cHJlc3Npb24gbWF0cml4XG5waGVubyA8LSBwRGF0YShlc2V0KVxuXG4jYXNzYXkgZGF0YSAoZWRhdGEpIGlmIHdvbnQgbG9hZCBhdCB3b3JrOlxuI2dlb2RhdGFbW1wiR1NFMjcyNzJfc2VyaWVzX21hdHJpeC50eHQuZ3pcIl1dQGFzc2F5RGF0YVtbXCJleHByc1wiXV1cblxuYGBgIn0= -->

```r
library(GEOquery)
geodata <-  getGEO("GSE27272", GSEMatrix = TRUE)
eset <- geodata[[1]]
edata <- exprs(eset) #expression matrix
pheno <- pData(eset)

#assay data (edata) if wont load at work:
#geodata[["GSE27272_series_matrix.txt.gz"]]@assayData[["exprs"]]

```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->

**Define Variables:**  
Dependent continuous variable = "characteristics_ch1.11"   cord blood cotinine (ng/ml)
Independent variable = expression level.


<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVjR2hsYm04a1kyaGhjbUZqZEdWeWFYTjBhV056WDJOb01TNHhNVnN4T2pOZFhHNWpiM0prWDJOdmJtTWdQQzBnWVhNdWJuVnRaWEpwWXlobmMzVmlLRndpTGlvNklGd2lMRndpWENJc2NHaGxibThrWTJoaGNtRmpkR1Z5YVhOMGFXTnpYMk5vTVM0eE1Ta3BYRzVqYjNKa1gyTnZibU5iTVRvMVhWeHVJeU1qWEc1Y2JpTnpkRzl5WlNCeVpYTjFiSFJ6SUdsdUlHUm1YRzVsZUhCeWN5NWtaaUE4TFNCa1lYUmhMbVp5WVcxbEtGeHVJQ0JuWlc1bElEMGdjbTkzTG01aGJXVnpLR1ZrWVhSaEtTeGNiaUFnYzIxbFlXNGdQU0JPUVN4Y2JpQWdjSFpoYkQwZ1RrRXNYRzRnSUdOcExteHZkMlZ5UFNCT1FTeGNiaUFnWTJrdWRYQndaWEk5SUU1QlhHNHBYRzRqWm05eUlDaHBJR2x1SURFNk1pbDdYRzVtYjNJZ0tHa2dhVzRnTVRwc1pXNW5kR2dvWldSaGRHRmJMREZkS1NsN0lDTnNiMjl3SUhSb2NtOTFaMmdnY205M2MxeHVJQ0IwYlhBdVpHWWdQQzBnWkdGMFlTNW1jbUZ0WlNoSFBXVmtZWFJoVzJrc1hTeERUMDVEUFdOdmNtUmZZMjl1WXlrN0kzQnlhVzUwS0hSdGNDNWtaaWtnSTIxaGEyVWdkR1Z0Y0c5eVlYSjVJR1JtSUdOdmJuUmhhVzVwYm1jZ1pYaHdjbVZ6YzJsdmJpQmtZWFJoSUdGdVpDQmhaMlZjYmlBZ0kyWnBkQ0JzYVc1bFlYSWdiVzlrWld3c0lITmhkbVVnYzJGdGNHeGxJRzFsWVc0Z1lXNWtJSEIyWVd4MVpTQnZaaUJuWlc1bFhHNGdJSFJ0Y0M1dGIyUmxiQ0E4TFNCc2JTaERUMDVEZmtjc0lIUnRjQzVrWmlrZ0kyWnBkQ0JzYVc1bFlYSWdiVzlrWld3Z1puSnZiU0JrWmx4dUlDQnpMblJ0Y0M1dGIyUmxiQ0E4TFNCemRXMXRZWEo1S0hSdGNDNXRiMlJsYkNsY2JpQWdaWGh3Y25NdVpHWWtjMjFsWVc1YmFWMGdQQzBnWTI5bFppaHpMblJ0Y0M1dGIyUmxiQ2xiTWl3Z1hDSkZjM1JwYldGMFpWd2lYVnh1SUNCbGVIQnljeTVrWmlSd2RtRnNXMmxkSUR3dElHTnZaV1lvY3k1MGJYQXViVzlrWld3cFd6SXNJRndpVUhJb1BueDBmQ2xjSWwxY2JpQWdYRzRnSUNOallXeGpJRU5KY3lCbWIzSWdaMlZ1WlNCbGVIQnlaWE56YVc5dUlHTnZaV1ptYVdOcFpXNTBYRzRnSUhSdGNDNWphU0E4TFNCamIyNW1hVzUwS0hSdGNDNXRiMlJsYkNsY2JpQWdaWGh3Y25NdVpHWWtZMmt1Ykc5M1pYSWdQQzBnZEcxd0xtTnBXeklzTVYwZ0kwY2dhWE1nYjI0Z2NtOTNJSFIzYnlCdlppQjBiWEF1WTJsY2JpQWdaWGh3Y25NdVpHWWtZMmt1ZFhCd1pYSWdQQzBnZEcxd0xtTnBXeklzTWwxY2JuMWNibUJnWUNKOSAtLT5cblxuYGBgclxucGhlbm8kY2hhcmFjdGVyaXN0aWNzX2NoMS4xMVsxOjNdXG5jb3JkX2NvbmMgPC0gYXMubnVtZXJpYyhnc3ViKFwiLio6IFwiLFwiXCIscGhlbm8kY2hhcmFjdGVyaXN0aWNzX2NoMS4xMSkpXG5jb3JkX2NvbmNbMTo1XVxuIyMjXG5cbiNzdG9yZSByZXN1bHRzIGluIGRmXG5leHBycy5kZiA8LSBkYXRhLmZyYW1lKFxuICBnZW5lID0gcm93Lm5hbWVzKGVkYXRhKSxcbiAgc21lYW4gPSBOQSxcbiAgcHZhbD0gTkEsXG4gIGNpLmxvd2VyPSBOQSxcbiAgY2kudXBwZXI9IE5BXG4pXG4jZm9yIChpIGluIDE6Mil7XG5mb3IgKGkgaW4gMTpsZW5ndGgoZWRhdGFbLDFdKSl7ICNsb29wIHRocm91Z2ggcm93c1xuICB0bXAuZGYgPC0gZGF0YS5mcmFtZShHPWVkYXRhW2ksXSxDT05DPWNvcmRfY29uYyk7I3ByaW50KHRtcC5kZikgI21ha2UgdGVtcG9yYXJ5IGRmIGNvbnRhaW5pbmcgZXhwcmVzc2lvbiBkYXRhIGFuZCBhZ2VcbiAgI2ZpdCBsaW5lYXIgbW9kZWwsIHNhdmUgc2FtcGxlIG1lYW4gYW5kIHB2YWx1ZSBvZiBnZW5lXG4gIHRtcC5tb2RlbCA8LSBsbShDT05DfkcsIHRtcC5kZikgI2ZpdCBsaW5lYXIgbW9kZWwgZnJvbSBkZlxuICBzLnRtcC5tb2RlbCA8LSBzdW1tYXJ5KHRtcC5tb2RlbClcbiAgZXhwcnMuZGYkc21lYW5baV0gPC0gY29lZihzLnRtcC5tb2RlbClbMiwgXCJFc3RpbWF0ZVwiXVxuICBleHBycy5kZiRwdmFsW2ldIDwtIGNvZWYocy50bXAubW9kZWwpWzIsIFwiUHIoPnx0fClcIl1cbiAgXG4gICNjYWxjIENJcyBmb3IgZ2VuZSBleHByZXNzaW9uIGNvZWZmaWNpZW50XG4gIHRtcC5jaSA8LSBjb25maW50KHRtcC5tb2RlbClcbiAgZXhwcnMuZGYkY2kubG93ZXIgPC0gdG1wLmNpWzIsMV0gI0cgaXMgb24gcm93IHR3byBvZiB0bXAuY2lcbiAgZXhwcnMuZGYkY2kudXBwZXIgPC0gdG1wLmNpWzIsMl1cbn1cbmBgYFxuXG48IS0tIHJuYi1zb3VyY2UtZW5kIC0tPlxuIn0= -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxucGhlbm8kY2hhcmFjdGVyaXN0aWNzX2NoMS4xMVsxOjNdXG5jb3JkX2NvbmMgPC0gYXMubnVtZXJpYyhnc3ViKFwiLio6IFwiLFwiXCIscGhlbm8kY2hhcmFjdGVyaXN0aWNzX2NoMS4xMSkpXG5jb3JkX2NvbmNbMTo1XVxuIyMjXG5cbiNzdG9yZSByZXN1bHRzIGluIGRmXG5leHBycy5kZiA8LSBkYXRhLmZyYW1lKFxuICBnZW5lID0gcm93Lm5hbWVzKGVkYXRhKSxcbiAgc21lYW4gPSBOQSxcbiAgcHZhbD0gTkEsXG4gIGNpLmxvd2VyPSBOQSxcbiAgY2kudXBwZXI9IE5BXG4pXG4jZm9yIChpIGluIDE6Mil7XG5mb3IgKGkgaW4gMTpsZW5ndGgoZWRhdGFbLDFdKSl7ICNsb29wIHRocm91Z2ggcm93c1xuICB0bXAuZGYgPC0gZGF0YS5mcmFtZShHPWVkYXRhW2ksXSxDT05DPWNvcmRfY29uYyk7I3ByaW50KHRtcC5kZikgI21ha2UgdGVtcG9yYXJ5IGRmIGNvbnRhaW5pbmcgZXhwcmVzc2lvbiBkYXRhIGFuZCBhZ2VcbiAgI2ZpdCBsaW5lYXIgbW9kZWwsIHNhdmUgc2FtcGxlIG1lYW4gYW5kIHB2YWx1ZSBvZiBnZW5lXG4gIHRtcC5tb2RlbCA8LSBsbShDT05DfkcsIHRtcC5kZikgI2ZpdCBsaW5lYXIgbW9kZWwgZnJvbSBkZlxuICBzLnRtcC5tb2RlbCA8LSBzdW1tYXJ5KHRtcC5tb2RlbClcbiAgZXhwcnMuZGYkc21lYW5baV0gPC0gY29lZihzLnRtcC5tb2RlbClbMiwgXCJFc3RpbWF0ZVwiXVxuICBleHBycy5kZiRwdmFsW2ldIDwtIGNvZWYocy50bXAubW9kZWwpWzIsIFwiUHIoPnx0fClcIl1cbiAgXG4gICNjYWxjIENJcyBmb3IgZ2VuZSBleHByZXNzaW9uIGNvZWZmaWNpZW50XG4gIHRtcC5jaSA8LSBjb25maW50KHRtcC5tb2RlbClcbiAgZXhwcnMuZGYkY2kubG93ZXIgPC0gdG1wLmNpWzIsMV0gI0cgaXMgb24gcm93IHR3byBvZiB0bXAuY2lcbiAgZXhwcnMuZGYkY2kudXBwZXIgPC0gdG1wLmNpWzIsMl1cbn1cbmBgYCJ9 -->

```r
pheno$characteristics_ch1.11[1:3]
cord_conc <- as.numeric(gsub(".*: ","",pheno$characteristics_ch1.11))
cord_conc[1:5]
###

#store results in df
exprs.df <- data.frame(
  gene = row.names(edata),
  smean = NA,
  pval= NA,
  ci.lower= NA,
  ci.upper= NA
)
#for (i in 1:2){
for (i in 1:length(edata[,1])){ #loop through rows
  tmp.df <- data.frame(G=edata[i,],CONC=cord_conc);#print(tmp.df) #make temporary df containing expression data and age
  #fit linear model, save sample mean and pvalue of gene
  tmp.model <- lm(CONC~G, tmp.df) #fit linear model from df
  s.tmp.model <- summary(tmp.model)
  exprs.df$smean[i] <- coef(s.tmp.model)[2, "Estimate"]
  exprs.df$pval[i] <- coef(s.tmp.model)[2, "Pr(>|t|)"]
  
  #calc CIs for gene expression coefficient
  tmp.ci <- confint(tmp.model)
  exprs.df$ci.lower <- tmp.ci[2,1] #G is on row two of tmp.ci
  exprs.df$ci.upper <- tmp.ci[2,2]
}
```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->

Order genes by p-values

<!-- rnb-text-end -->


<!-- rnb-chunk-begin -->


<!-- rnb-output-begin eyJkYXRhIjoiXG48IS0tIHJuYi1zb3VyY2UtYmVnaW4gZXlKa1lYUmhJam9pWUdCZ2NseHVJM052Y25RZ1pHWXNJR0Z6WTJWdVpHbHVaeUJ2Y21SbGNseHVZR0JnSW4wPSAtLT5cblxuYGBgclxuI3NvcnQgZGYsIGFzY2VuZGluZyBvcmRlclxuYGBgXG5cbjwhLS0gcm5iLXNvdXJjZS1lbmQgLS0+XG4ifQ== -->


<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuI3NvcnQgZGYsIGFzY2VuZGluZyBvcmRlclxuYGBgIn0= -->

```r
#sort df, ascending order
```

<!-- rnb-source-end -->


<!-- rnb-output-end -->

<!-- rnb-chunk-end -->


<!-- rnb-text-begin -->



<!-- rnb-text-end -->

